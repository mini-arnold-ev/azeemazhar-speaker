---
interface Props {
  /** YouTube video ID (e.g. "HzlsKrMO5M4") or full YouTube URL */
  id?: string;
  src?: string;
  title?: string;
}

const { id, src, title = "Video" } = Astro.props;

// Accept either a bare YouTube ID or a full URL
let embedUrl: string;
if (id) {
  embedUrl = `https://www.youtube-nocookie.com/embed/${id}`;
} else if (src) {
  // Extract ID from various YouTube URL forms
  const match = src.match(/(?:v=|youtu\.be\/|embed\/)([^&?/]+)/);
  const videoId = match ? match[1] : src;
  embedUrl = `https://www.youtube-nocookie.com/embed/${videoId}`;
} else {
  embedUrl = '';
}
---

{embedUrl && (
  <div class="relative w-full overflow-hidden rounded-sm" style="padding-bottom: 56.25%;">
    <iframe
      src={embedUrl}
      title={title}
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen
      loading="lazy"
      class="absolute inset-0 w-full h-full border-0"
    />
  </div>
)}
